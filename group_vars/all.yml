---
# Stage switches
run_lynis_scan: true
run_os_hardening: false

# APT repository settings
apt_repository_url: "http://deb.debian.org/debian"
apt_security_repository_url: "http://security.debian.org/debian-security"
# Debian only; Ubuntu keeps distro defaults unless you add an Ubuntu role later.
apt_debian_components:
  - main
  - contrib
  - non-free
  - non-free-firmware

# Lynis settings
lynis_repo_url: "https://github.com/CISOfy/lynis"
lynis_install_path: "/opt/lynis"
lynis_report_output_dir: "{{ playbook_dir }}/../artifacts/lynis"
lynis_quick_mode: true

# Preparation baseline (idempotent replacement for bootstrap script)
prep_enabled: true
prep_root_authorized_keys: []
prep_manage_primary_user: true
prep_primary_user_uid: "1000"

# Network identity hardening
network_identity_manage_hosts: true
# Avoid changing DNS settings by default; enable and set nameservers for your environment.
network_identity_manage_resolv_conf: false
network_identity_primary_ipv4: ""
network_identity_nameservers: []
network_identity_search_domains: []
network_identity_set_hostname: true
network_identity_hostname: "{{ (network_identity_fqdn if (network_identity_fqdn | length > 0) else inventory_hostname).split('.')[0] }}"
network_identity_fqdn: "{{ inventory_hostname if '.' in inventory_hostname else '' }}"
network_identity_manage_loopback_fqdn: true
network_identity_manage_hosts_via_template: true
network_identity_cleanup_stale_hostname_entries: true
network_identity_extra_hosts_entries: []

# Package/update hardening
package_hardening_enable_unattended_upgrades: true
package_hardening_run_dist_upgrade: true
package_hardening_debsums_cron_check: "weekly"
package_hardening_purge_removed_packages: true

# Authentication hardening
auth_apply_to_existing_local_users: true
auth_apply_to_root: true
auth_skip_users: []

# SSH hardening
ssh_port: 2222
ssh_allow_password_auth: false
# Root SSH access is allowed by SSH key only (no password auth).
ssh_allow_root_login: true
ssh_allowed_users: []
ssh_disable_pam_motd: true
ssh_print_last_log: true
ssh_clean_login_output: true
ssh_disable_motd_news: true

# Login banners
banner_issue_text: |
  +------------------------------------------------------------------+
  | SECURITY NOTICE: AUTHORIZED ACCESS ONLY                          |
  | This system is private property.                                 |
  | Access is restricted to authorized users only.                   |
  | All activity is monitored and recorded.                          |
  | Unauthorized use is prohibited and may be prosecuted.            |
  | Disconnect immediately if you are not authorized.                |
  +------------------------------------------------------------------+
banner_issue_net_text: |
  +------------------------------------------------------------------+
  | SECURITY NOTICE: AUTHORIZED SSH ACCESS ONLY                      |
  | This SSH service is private property.                            |
  | Access is restricted to authorized users only.                   |
  | All activity is monitored and recorded.                          |
  | Unauthorized use is prohibited and may be prosecuted.            |
  | Disconnect immediately if you are not authorized.                |
  +------------------------------------------------------------------+

# Kernel/module hardening
kernel_sysctl_dropin_path: /etc/sysctl.d/99-zz-hardening.conf
kernel_disable_usb_storage: true
kernel_disable_firewire_storage: true
kernel_disable_core_dumps: true
kernel_lock_module_loading: false

# File permissions hardening
file_permissions_hardening_enabled: true

# Integrity tooling
integrity_initialize_aide: true
integrity_aide_checksum_algorithm: sha512

# Optional external log forwarding
remote_syslog_enabled: false
remote_syslog_host: ""
remote_syslog_port: 514
remote_syslog_protocol: "tcp"

# Firewall (iptables-persistent)
firewall_default_input_policy: "DROP"
firewall_default_forward_policy: "DROP"
firewall_default_output_policy: "ACCEPT"
firewall_allow_icmp_v4: true
firewall_allow_icmp_v6: true
firewall_enable_extra_input_hardening: true
# If true, allow SSH from any source; set false and define firewall_allowed_ssh_cidrs to restrict.
firewall_allow_ssh_from_anywhere: true
# Populate with CIDRs only when firewall_allow_ssh_from_anywhere is false.
firewall_allowed_ssh_cidrs: []

# Fail2ban
fail2ban_bantime: "1h"
fail2ban_findtime: "10m"
fail2ban_maxretry: 5

# Session log retention
ssh_session_log_file: "/var/log/ssh_sessions.log"
ssh_session_logrotate_days: 30
